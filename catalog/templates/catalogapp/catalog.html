{% extends 'base.html' %}
{% load static %}
{%block name%}
catalogg
{%endblock%}
{%block content%}
<div class="catalog-blok">
  <div class="category-blok2">
    <button class="btn btn-primary" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasTop" aria-controls="offcanvasTop" style="background-color: white;color: black;">Filter</button>
    <div class="sales-hits-line" style="background-color: D2F018;height: 40px;display: flex;justify-content: center;">
      <h2 style="position: relative;background-color: #D2F018;">Sales Hits</h2>
    </div>
    <div class="cataloggg">
      <div class="sales-hits-product" style="display: flex;width: 100%;background: #3D7F88;"> 
        {% for product in hits %}
        <div class="product" style="width: 18rem;"></div>
        <div class="catalogg ">
          <img src="{{product.image.url}}" class="card-img-top" alt=".s..">
          <div class="card-body">
            <h2>{{product.name}}</h2>
            <span>{{product.price}}$</span>
            <a href="{{ product.get_absolute_url }}" class="btn btn-primary">Detailed description</a>
          </div>
        </div>
     
          {% endfor %}
        </div>
        </div>
    
    <div class="cataloggg">
      {% for product in list_products %}
      <div class="product.category">
      <div class="product " style="width: 18rem;">
        <div class="catalogg">
          <img src="{{product.image.url}}" class="card-img-top" alt=".s..">
          <div class="card-body">
            <h2>{{product.name}}</h2>
            <span>{{product.price}}$</span>
            <a href="{{ product.get_absolute_url }}" class="btn btn-primary">Detailed description</a>
          </div>
        </div>
      </div>
      </div>
      {%endfor%}
    </div>
    </div>
  </div>
  </div>
  <div class="offcanvas offcanvas-top canvas" tabindex="-1" id="offcanvasTop" aria-labelledby="offcanvasTopLabel" style="background-color: white;">
    <div class="offcanvas-header" style="background-color: white;">
      <h5 class="offcanvas-title" id="offcanvasTopLabel">Filters</h5>
      <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body filters">
      {% for category in additional_category %}
        <div class="manufacturers">
          <input type="checkbox" class="check" value="{{ category.name }}" checked>
          <p>{{category.name}}</p>
        </div>
      {% endfor %}
    </div>
  </div>
</div>
  
<script>
  const list = document.querySelector('.offcanvas-body.filters');
  const productItems = document.querySelectorAll('.product');
  const checkboxes = document.querySelectorAll('.manufacturers input[type="checkbox"]');
  const hitsProducts = document.querySelectorAll('.sales-hits-product-body-card');

  function filter() {
    checkboxes.forEach(checkbox => {
      checkbox.addEventListener('change', () => {
        const selectedManufacturers = Array.from(checkboxes)
          .filter(checkbox => checkbox.checked)
          .map(checkbox => checkbox.value);

        filterItems(selectedManufacturers);
      });
    });
  }

  function filterItems(selectedManufacturers) {
    productItems.forEach(item => {
      const manufacturer = item.classList[1];

      if (selectedManufacturers.includes(manufacturer)) {
        item.style.display = 'flex';
      } else {
        item.style.display = 'none';
      }
    });
  }

  filter();
</script>
{%endblock%}
